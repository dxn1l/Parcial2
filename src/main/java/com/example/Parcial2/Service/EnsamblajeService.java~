package com.example.Parcial2.Service;

import com.example.Parcial2.Entity.DatoDistribucion;
import org.springframework.amqp.rabbit.annotation.RabbitListener;
import org.springframework.stereotype.Service;
import reactor.core.publisher.Mono;

@Service
public class EnsamblajeService {

    @RabbitListener(queues = "productionQueue")
    public Mono<Void> receiveMessage(DatoDistribucion dato) {
        return Mono.fromRunnable(() -> {
            System.out.println("Ensamblando dato recibido: " + dato);
            // Lógica de ensamblaje aquí
        }).then();
    }
}
